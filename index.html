async function loadMarkers() {
    try {
        const response = await fetch(sheetURL);
        const csvText = await response.text();
        const rows = csvText.split('\n').slice(1); // Ignore the header row

        console.log('CSV chargé avec succès : ', csvText); // Affiche tout le CSV pour déboguer

        let markersLoaded = 0;

        // Parcourir toutes les lignes du CSV
        rows.forEach(row => {
            const cols = row.split(','); // Diviser la ligne en colonnes

            // Ignorer les lignes mal formatées (avec trop ou trop peu de colonnes)
            if (cols.length !== 4) {
                console.log(`Ligne ignorée : mauvaise structure - ${row}`);
                return; // Ignorer cette ligne
            }

            const name = cols[0].trim(); // Nom de l'élément (Aéroport, Bâtiment, Avion)
            const lat = parseFloat(cols[1].trim().replace(',', '.')); // Latitude
            const lng = parseFloat(cols[2].trim().replace(',', '.')); // Longitude
            const imageUrl = cols[3].trim(); // URL de l'image

            console.log(`Traitement ligne: ${cols}`);

            // Ajouter le marqueur si les valeurs de latitude et longitude sont valides
            if (!isNaN(lat) && !isNaN(lng)) {
                // Créer l'icône à partir de l'URL de l'image
                const icon = L.icon({
                    iconUrl: imageUrl,
                    iconSize: [32, 32], // Taille de l'icône
                    iconAnchor: [16, 32], // Point d'ancrage de l'icône
                    popupAnchor: [0, -32] // Point d'ancrage du popup
                });

                // Ajouter le marqueur à la carte
                L.marker([lat, lng], { icon }).addTo(map)
                    .bindPopup(`<strong>${name}</strong><br>Lat: ${lat}, Lng: ${lng}`);
                markersLoaded++;
            } else {
                console.log(`Marqueur ignoré pour ${name}, Latitude: ${lat}, Longitude: ${lng}`);
            }
        });

        // Afficher un message si aucun marqueur n'a été ajouté
        if (markersLoaded === 0) {
            console.log("Aucun marqueur ajouté. Vérifie les données CSV.");
        }

    } catch (error) {
        console.error('Erreur lors du chargement des données CSV :', error);
        alert('Erreur lors du chargement des données CSV. Vérifie l\'URL ou les données.');
    }
}
